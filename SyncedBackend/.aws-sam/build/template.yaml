AWSTemplateFormatVersion: '2010-09-09'
Description: Main Stack for SyncedBackend
Resources:
  DatabaseStack:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: DatabaseStack/template.yaml
    Metadata:
      SamResourceId: DatabaseStack
  LambdaStack:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: LambdaStack/template.yaml
      Parameters:
        CollaborativePlaylistTableName:
          Fn::GetAtt:
          - DatabaseStack
          - Outputs.CollaborativePlaylistTableName
        UsersTableName:
          Fn::GetAtt:
          - DatabaseStack
          - Outputs.UsersTableName
    Metadata:
      SamResourceId: LambdaStack
  CognitoStack:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: CognitoStack/template.yaml
      Parameters:
        CognitoTriggerFunctionArn:
          Fn::GetAtt:
          - LambdaStack
          - Outputs.CognitoTriggerFunctionArn
    Metadata:
      SamResourceId: CognitoStack
  ApiStack:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: ApiStack/template.yaml
      Parameters:
        GetAllCollaborativePlaylistsFunctionArn:
          Fn::GetAtt:
          - LambdaStack
          - Outputs.GetAllCollaborativePlaylistsFunctionArn
        UserPoolId:
          Fn::GetAtt:
          - CognitoStack
          - Outputs.UserPoolId
    Metadata:
      SamResourceId: ApiStack
